function fetchNewItems(){setInterval(function(){items.fetch({success:function(){console.log("Sweet! Fetching new items for you.")},error:function(){console.log("Unfortuntely cannot fetch new messages at this time.")}})},12e4)}function sortItems(){items.comparator="price",items.sort(),$(".list-of-items").empty(""),items.each(function(a){new ListView({model:a})})}var MainRouter=Backbone.Router.extend({routes:{"":"listItems","items/:id":"focusOnItem",sort:"sortItems"},initialize:function(){window.items=new ItemsCollection},listItems:function(a){a&&(this.items.url="https://api.etsy.com/v2/listings/active.js?keywords=ceramic,pottery"+a+"&api_key=42hmr9rr7q7wvj31sce3ofwt&includes=Images&limit=500&callback=?"),items.fetch()},focusOnItem:function(a){var b=items.find(function(b){return b.get("listing_id")==a});new FocusView({model:b})}}),Item=Backbone.Model.extend({}),ItemsCollection=Backbone.Collection.extend({model:Item,url:"https://api.etsy.com/v2/listings/active.js?keywords=ceramic,pottery&api_key=42hmr9rr7q7wvj31sce3ofwt&includes=Images&callback=?",parse:function(a){return a.results},initialize:function(){this.on("add",function(a){new ListView({model:a})})}}),ListView=Backbone.View.extend({tagName:"a",className:"js-item-list-version item-list-version",createTemplate:_.template($("#list-view-template").text()),initialize:function(){this.setHrefAttr(),$(".js-list-of-items").append(this.el),this.render()},render:function(){this.$el.html(this.createTemplate(this.model))},setHrefAttr:function(){var a=this.model.get("listing_id"),b="#/items/"+a;this.$el.attr({href:b})}}),FocusView=Backbone.View.extend({className:"focus-view",createTemplate:_.template($("#focus-view-template").text()),initialize:function(){$(".js-main-view").html(this.el),this.render()},render:function(){this.$el.html(this.createTemplate(this.model))}}),SearchView=Backbone.View.extend({events:{"search/:keyword":"showSearchResults"},initialize:function(){setKeyword(),$(".search-results").append(this.el),this.render()},render:function(){this.$el.html(this.createTemplate(this.model))},showSearchResults:function(a){a&&(this.items.url="https://api.etsy.com/v2/listings/active.js?keywords=ceramic,pottery,"+a+"&api_key=42hmr9rr7q7wvj31sce3ofwt&includes=Images&callback=?"),this.items.fetch()},setKeyword:function(){var a=$(".js-keyword-search").val(),b="#/search/"+a;$(".js-search-btn").attr({href:b})}});console.log("manbearpig"),$(document).ready(function(){router=new MainRouter,Backbone.history.start(),fetchNewItems(),$(".sort-by-price").click(function(){sortItems()}),$(".search-items").click(function(){$(".search-results").html(_.template($(".search-template").text()))})});